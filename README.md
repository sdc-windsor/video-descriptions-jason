# Vimeo: Video Descriptions

> This Video Descriptions repo is one component of a larger Vimeo mock, which utilizes microservices architecture. It depends on the existence of related Vimeo services, namely the Video Player and Video Recommendation services. This README was authored by the expander and optimizer of the backend, not by the creator of the frontend. Hence, it focuses on backend functionality.

## Related Projects

  - https://github.com/sdc-windsor/video-player
  - https://github.com/sdc-windsor/video-recommendations

## Usage

### Generating Data

> The repo includes a data generation script, which creates any number of fake video descriptions, users, and comments and saves them to CSV files in the 'data' directory. To run the script, execute the command "npm run generate" in your terminal. Use it carefully! By default, it generates 10 million descriptions, ~45 million comments, and 100,000 users, and takes approximately an hour (depending on the speed of your computer). The resulting file sizes are 2.57 GB for descriptions, 11.25 GB for comments, and 8.5 MB for users.

> If desired, test data can be generated by setting NODE_ENV to test when executing the script. E.g.: "NODE_ENV=test npm run generate" (don't use the quotes). By default, this will create only 100 descriptions (the primary record), ~450 comments, and 10 users. These files will be saved to the data-test directory. This is a great way to familiarize yourself with the shape of the data before committing to a much larger output.

### Seeding PostgreSQL

> To seed the database, simply execute the command "npm run seed" in your terminal. The contents of the CSV files in the data directory (or in the data-test directory if you're in the test environment) will be streamed into PostgreSQL. This process takes approximately 30 minutes.

## Requirements

- Node 11.12.0
- PostgreSQL 11
- A .env file with environmental variables for testing, development, and production. Here's an example:
```env
# Development
PORT_DEV=3003
DATA_DEV='../data'
DESCRIPTIONS_QTY_DEV=10000000
USERS_QTY_DEV=100000

PG_HOST_DEV='localhost'
PG_USER_DEV='postgres'
PG_DB_DEV='sdc'
PG_PASSWORD_DEV='postgres'
PG_PORT_DEV=5432

# Testing
PORT_TEST=3003
DATA_TEST='../data-test'
DESCRIPTIONS_QTY_TEST=100
USERS_QTY_TEST=10

PG_HOST_TEST='localhost'
PG_USER_TEST='postgres'
PG_DB_TEST='test'
PG_PASSWORD_TEST='postgres'
PG_PORT_TEST=5432

# Production
PORT=3003
DATA='../data'
DESCRIPTIONS_QTY=10000000
USERS_QTY=100000

PG_HOST='localhost'
PG_USER='postgres'
PG_DB='test'
PG_PASSWORD='postgres'
PG_PORT=5432
```

### Installing Dependencies

From within the root directory:

```sh
npm install
```

